<%- include('../partials/header') %>
<div class="container">
  <div class="flex flex-between flex-center mb-2">
    <h1 style="color: #f59e0b;">Admin Control Panel</h1>
    <div style="display: flex; gap: 0.5rem;">
      <a href="/admin/users" class="btn btn-primary btn-sm">Users</a>
      <a href="/admin/towers" class="btn btn-primary btn-sm">Towers</a>
      <a href="/admin/plans" class="btn btn-primary btn-sm">Plans</a>
      <a href="/admin/logs" class="btn btn-primary btn-sm">Logs</a>
    </div>
  </div>

  <% if (typeof message !== 'undefined' && message) { %>
    <div class="alert alert-info"><%= message %></div>
  <% } %>

  <div class="grid-4 mb-2">
    <div class="stat-card" style="border-color: #3b82f6;">
      <div class="stat-value" style="color: #3b82f6;"><%= parseInt(stats.totalUsers).toLocaleString() %></div>
      <div class="stat-label">Total Users</div>
    </div>
    <div class="stat-card" style="border-color: #22c55e;">
      <div class="stat-value" style="color: #22c55e;"><%= parseInt(stats.totalApiKeys).toLocaleString() %></div>
      <div class="stat-label">API Keys</div>
    </div>
    <div class="stat-card" style="border-color: #f59e0b;">
      <div class="stat-value" style="color: #f59e0b;"><%= parseInt(stats.totalTowers).toLocaleString() %></div>
      <div class="stat-label">BTS Towers</div>
    </div>
    <div class="stat-card" style="border-color: #a78bfa;">
      <div class="stat-value" style="color: #a78bfa;"><%= parseInt(stats.totalLookups).toLocaleString() %></div>
      <div class="stat-label">Total Lookups</div>
    </div>
  </div>

  <div class="grid-4 mb-2">
    <div class="stat-card">
      <div class="stat-value"><%= stats.totalProvinces %></div>
      <div class="stat-label">Provinsi</div>
    </div>
    <div class="stat-card">
      <div class="stat-value"><%= parseInt(stats.totalCities).toLocaleString() %></div>
      <div class="stat-label">Kab/Kota</div>
    </div>
    <div class="stat-card">
      <div class="stat-value"><%= parseInt(stats.activeKeys).toLocaleString() %></div>
      <div class="stat-label">Active Keys</div>
    </div>
    <div class="stat-card">
      <div class="stat-value"><%= parseInt(stats.todayLookups).toLocaleString() %></div>
      <div class="stat-label">Lookups Hari Ini</div>
    </div>
  </div>

  <div class="grid-2">
    <div class="card">
      <h3 class="mb-1">User Terbaru</h3>
      <table>
        <thead><tr><th>Username</th><th>Email</th><th>Plan</th><th>Status</th><th>Tanggal</th></tr></thead>
        <tbody>
          <% recentUsers.forEach(function(u) { %>
            <tr>
              <td><%= u.username %></td>
              <td><%= u.email %></td>
              <td><span class="badge badge-<%= u.plan %>"><%= u.plan.toUpperCase() %></span></td>
              <td><span class="badge <%= u.is_active ? 'badge-active' : 'badge-inactive' %>"><%= u.is_active ? 'Active' : 'Inactive' %></span></td>
              <td><%= new Date(u.created_at).toLocaleDateString('id-ID') %></td>
            </tr>
          <% }); %>
        </tbody>
      </table>
    </div>

    <div class="card">
      <h3 class="mb-1">Lookup Terbaru</h3>
      <table>
        <thead><tr><th>User</th><th>MSISDN</th><th>Operator</th><th>Waktu</th></tr></thead>
        <tbody>
          <% recentLookups.forEach(function(l) { %>
            <tr>
              <td><%= l.username %></td>
              <td><%= l.msisdn %></td>
              <td><%= l.operator_name %></td>
              <td><%= new Date(l.created_at).toLocaleString('id-ID') %></td>
            </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
  </div>
</div>
<%- include('../partials/footer') %>
